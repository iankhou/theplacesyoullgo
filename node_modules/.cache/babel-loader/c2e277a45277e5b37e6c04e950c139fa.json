{"ast":null,"code":"var _jsxFileName = \"/Users/ikh/localdev/otpyg/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from \"react\";\nimport ReactDOM from \"react-dom\"; // eslint-disable-next-line\n\nimport mapboxgl from \"!mapbox-gl\";\nimport axios from \"axios\";\nimport Button from \"@mui/material/Button\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Autocomplete from \"@mui/material/Autocomplete\";\nimport TextField from \"@mui/material/TextField\";\nimport { ThemeProvider, createTheme } from \"@mui/material/styles\";\nimport { deepPurple } from \"@mui/material/colors\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\"; // import ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\n\nimport \"react-responsive-modal/styles.css\";\nimport { Modal } from \"react-responsive-modal\";\nimport \"./App.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { createElement as _createElement } from \"react\";\nmapboxgl.accessToken = \"pk.eyJ1IjoiaWFua2hvdSIsImEiOiJja3U1enMzNHE0enN4Mm9waXNwcDlyeGVpIn0.gz1TKA2H5JfDkMiHkdVxRQ\";\nexport default function App() {\n  _s();\n\n  // update users from Google Sheet\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n  const [users, setUsers] = useState(null);\n  const [lng, setLng] = useState(-98.0822);\n  const [lat, setLat] = useState(39.6719);\n  const [zoom, setZoom] = useState(3);\n  const [search, setSearch] = useState(false);\n  const [displayRoommates, setDisplayRoommates] = useState(false);\n  const theme = createTheme({\n    palette: {\n      mode: \"dark\",\n      primary: {\n        main: deepPurple[400]\n      }\n    }\n  });\n  useEffect(() => {\n    if (!map.current) return; // wait for map to initialize\n\n    map.current.on(\"move\", () => {\n      setLng(map.current.getCenter().lng.toFixed(4));\n      setLat(map.current.getCenter().lat.toFixed(4));\n      setZoom(map.current.getZoom().toFixed(2));\n    });\n  });\n\n  function addPopup(el, coords) {\n    const placeholder = document.createElement(\"div\");\n    ReactDOM.render(el, placeholder);\n    new mapboxgl.Popup().setDOMContent(placeholder).setLngLat(coords).addTo(map.current);\n  }\n\n  const formPopup = users => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: users.map(user => {\n        console.log(user);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: `${user[\"name\"]} '${user[\"year\"]}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 6\n          }, this), user[\"roommate\"] ? /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: /*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Looking for a house/roommate\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 30\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 26\n          }, this) : null, /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Major(s): \", user[\"major\"]]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"What I'm doing here: \", user[\"activity\"]]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 6\n          }, this), user[\"contact\"] ? /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Contact: \", user[\"contact\"]]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 25\n          }, this) : null, /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Last updated: \", new Date(user[\"timestamp\"]).toLocaleDateString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 6\n          }, this)]\n        }, `USER_INFO_BOX_FOR_${user[\"email\"]}`, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 12\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 10\n    }, this);\n  };\n\n  useEffect(() => {\n    if (users) return;\n    const axiosStart = performance.now();\n    axios.get(\"https://script.google.com/macros/s/AKfycbw4H4dqvK6b4iIW_RkF80__SzI3bpCi0k6-OxQdv2-utpXJbcTY8d_KsdIOS-BSfEENxg/exec\").then(resp => {\n      const axiosEnd = performance.now();\n      console.log(`Axios call took ${axiosEnd - axiosStart} milliseconds`);\n      const features = {};\n      const uniqueStart = performance.now();\n      resp.data.forEach(d => {\n        features[d[\"Email Address\"]] = {\n          type: \"Feature\",\n          properties: {\n            weight: 1,\n            users: [{\n              timestamp: d[\"Timestamp\"],\n              name: d[\"Name (First Last)\"],\n              year: d[\"Year\"],\n              major: d[\"Major(s)\"],\n              activity: d[\"What will you be doing there (ex. Working at McDonalds as a Software Engineer)?\"],\n              roommate: d[\"Are you looking for a house/roommate?\"] == \"Yes\" ? true : false,\n              contact: d[\"Contact information\"],\n              email: d[\"Email Address\"]\n            }],\n            attention: d[\"Are you looking for a house/roommate?\"] == \"Yes\" ? 1 : 0\n          },\n          geometry: {\n            type: \"Point\",\n            coordinates: [d[\"Longitude\"], d[\"Latitude\"]]\n          }\n        };\n      });\n      setUsers(features);\n      const uniqueEnd = performance.now();\n      console.log(`Eliminating duplicate records took ${uniqueEnd - uniqueStart} milliseconds`);\n      const groupStart = performance.now(); // set contains coordinates [long, lat]\n\n      const locCache = new Set();\n      const groupedFeatures = [];\n      let groupI = 0; // map through each user\n\n      Object.values(features).forEach(e => {\n        const long = e[\"geometry\"][\"coordinates\"][0];\n        const lat = e[\"geometry\"][\"coordinates\"][1];\n        let found = false; // forEach through the cache and check for similar loc\n\n        locCache.forEach(c => {\n          // if sim loc, group into the first occurrence\n          if ((long - c[0]) ** 2 + (lat - c[1]) ** 2 < 0.001 ** 2) {\n            // append to prev user list, inc weight, keep geometry\n            const oldUserList = groupedFeatures[c[2]][\"properties\"][\"users\"];\n            const oldGeometry = groupedFeatures[c[2]][\"geometry\"];\n            const oldWeight = groupedFeatures[c[2]][\"properties\"][\"weight\"];\n            const oldAttention = groupedFeatures[c[2]][\"properties\"][\"attention\"];\n            groupedFeatures[c[2]] = {\n              type: \"Feature\",\n              properties: {\n                weight: oldWeight + 1,\n                users: [...oldUserList, e[\"properties\"][\"users\"][0]],\n                attention: +[oldAttention, e[\"properties\"][\"attention\"]].some(a => a === 1)\n              },\n              geometry: oldGeometry\n            };\n            found = true;\n          }\n        });\n\n        if (!found) {\n          // if you've made it this far, there is not a match\n          // push the uniquely-located user to the group\n          groupedFeatures.push(e); // cache their location and group index, increment group index\n\n          locCache.add([long, lat, groupI]);\n          groupI++;\n        }\n      });\n      const groupEnd = performance.now();\n      console.log(`Grouping records took ${groupEnd - groupStart} milliseconds`);\n      const userCollection = {\n        type: \"FeatureCollection\",\n        features: groupedFeatures\n      };\n      if (map.current) return; // initialize map only once\n\n      const mapStart = performance.now();\n      map.current = new mapboxgl.Map({\n        container: mapContainer.current,\n        style: \"mapbox://styles/mapbox/dark-v10\",\n        center: [lng, lat],\n        zoom: zoom\n      });\n      map.current.on(\"load\", () => {\n        map.current.addSource(\"users\", {\n          type: \"geojson\",\n          data: userCollection\n        });\n        map.current.addLayer({\n          id: \"users-heat\",\n          type: \"heatmap\",\n          source: \"users\",\n          maxzoom: 14,\n          paint: {\n            // increase weight as diameter breast height increases\n            \"heatmap-weight\": {\n              type: \"exponential\",\n              stops: [[1, 0], [500, 30]]\n            },\n            // increase intensity as zoom level increases\n            \"heatmap-intensity\": {\n              stops: [[11, 1], [15, 3]]\n            },\n            // assign color values to points depending on their density\n            \"heatmap-color\": [\"interpolate\", [\"linear\"], [\"heatmap-density\"], 0, \"rgba(255,153,153,0)\", 0.2, \"rgb(0,255,150)\", 0.4, \"rgb(50,204,0)\", 0.6, \"rgb(50,153,0)\", 0.8, \"rgb(50,102,0)\"],\n            // increase radius as zoom increases\n            \"heatmap-radius\": {\n              stops: [[11, 15], [15, 20]]\n            },\n            // decrease opacity to transition into the circle layer\n            \"heatmap-opacity\": {\n              default: 1,\n              stops: [[11, 1], [12, 0]]\n            }\n          }\n        }, \"waterway-label\");\n        map.current.addLayer({\n          id: \"users-point\",\n          type: \"circle\",\n          source: \"users\",\n          minzoom: 5,\n          paint: {\n            // increase the radius of the circle as the zoom level and weight increases\n            \"circle-radius\": 8,\n            \"circle-color\": {\n              property: \"attention\",\n              type: \"exponential\",\n              stops: [[0, \"rgb(0,225,0)\"], [1, \"rgb(255,200,0)\"]]\n            },\n            \"circle-stroke-color\": \"rgba(0,100,0, 0.3)\",\n            \"circle-stroke-width\": 1,\n            \"circle-opacity\": {\n              stops: [[11, 0], [12, 1]]\n            }\n          }\n        }, \"waterway-label\");\n        map.current.on(\"click\", \"users-point\", ({\n          features\n        }) => {\n          const {\n            users\n          } = features[0].properties;\n          const myComp = formPopup(JSON.parse(users));\n          addPopup(myComp, features[0].geometry.coordinates);\n        });\n      });\n      const mapEnd = performance.now();\n      console.log(`Mapping records took ${mapEnd - mapStart} milliseconds`);\n    });\n  });\n\n  const displayUsers = () => {\n    if (users) {\n      // Filter for users looking for roommates\n      const usersLookingForRoommate = Object.entries(users).filter(entry => {\n        return entry[1].properties.users[0].roommate === true;\n      });\n      console.log(usersLookingForRoommate);\n      return usersLookingForRoommate.map(([email, data]) => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: data.properties.users[0].name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 7\n          }, this)\n        }, email, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 6\n        }, this);\n      });\n    } else {\n      return null;\n    }\n  };\n\n  let options;\n\n  if (users) {\n    options = Object.keys(users).map(email => {\n      return {\n        email,\n        name: users[email].properties.users[0].name,\n        year: users[email].properties.users[0].year,\n        location: users[email].geometry.coordinates,\n        userData: users[email].properties.users\n      };\n    });\n  } else {\n    options = [];\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(ThemeProvider, {\n      theme: theme,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"top_left\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            marginBottom: 5\n          },\n          children: [\"Long: \", lng, \" | Lat: \", lat, \" | Zoom: \", zoom, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 74\n          }, this), \"Yellow dots need roommates (zoom in)\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 116\n          }, this), \"Add yourself to the map!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            marginRight: 10\n          },\n          className: \"action_button\",\n          size: \"small\",\n          variant: \"outlined\",\n          onClick: () => setSearch(true),\n          children: \"search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"action_button\",\n          size: \"small\",\n          variant: \"outlined\",\n          href: \"https://docs.google.com/forms/d/e/1FAIpQLSeL_-gto_kwPpzbZCJaGejjlfbrLwmW1TqobfToT4AHlxPIGA/viewform?usp=sf_link\",\n          children: \"students\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            margin: 10\n          },\n          className: \"action_button\",\n          size: \"small\",\n          variant: \"outlined\",\n          href: \"https://docs.google.com/forms/d/e/1FAIpQLSfN9_kXsE0C4RcdjWCGpTgGH4cwAgVoAeKLCxVW9voIYm4BLQ/viewform?usp=sf_link\",\n          children: \"alums\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"top_right\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"People looking for roommates:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 6\n        }, this), displayRoommates ? displayUsers() : null, /*#__PURE__*/_jsxDEV(IconButton, {\n          \"aria-label\": \"expand\",\n          color: \"primary\",\n          onClick: () => setDisplayRoommates(!displayRoommates),\n          children: /*#__PURE__*/_jsxDEV(ExpandMoreIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapContainer,\n      className: \"map-container\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      center: true,\n      classNames: {\n        overlay: \"customOverlay\",\n        modal: \"customModal\"\n      },\n      open: search,\n      onClose: () => setSearch(false),\n      children: /*#__PURE__*/_jsxDEV(ThemeProvider, {\n        theme: theme,\n        children: /*#__PURE__*/_jsxDEV(Autocomplete, {\n          options: options,\n          isOptionEqualToValue: (option, value) => option.email === value.email,\n          getOptionLabel: option => option.name,\n          autoComplete: true,\n          renderInput: params => /*#__PURE__*/_jsxDEV(TextField, { ...params,\n            label: \"Search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 32\n          }, this),\n          renderOption: (props, option) => /*#__PURE__*/_createElement(\"li\", { ...props,\n            key: option.email,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 40\n            }\n          }, option.name, \" (\\u2018\", option.year, \")\"),\n          sx: {\n            color: \"black\"\n          },\n          onChange: (e, val) => {\n            setSearch(false);\n            map.current.flyTo({\n              center: val.location,\n              zoom: 13\n            });\n            const myPopup = formPopup(val.userData);\n            addPopup(myPopup, val.location);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 330,\n    columnNumber: 3\n  }, this);\n}\n\n_s(App, \"l+972gHqkttBhmJRc8BzfsKbB5M=\");\n\n_c = App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/ikh/localdev/otpyg/src/App.js"],"names":["React","useRef","useEffect","useState","ReactDOM","mapboxgl","axios","Button","IconButton","Autocomplete","TextField","ThemeProvider","createTheme","deepPurple","ExpandMoreIcon","Modal","accessToken","App","mapContainer","map","users","setUsers","lng","setLng","lat","setLat","zoom","setZoom","search","setSearch","displayRoommates","setDisplayRoommates","theme","palette","mode","primary","main","current","on","getCenter","toFixed","getZoom","addPopup","el","coords","placeholder","document","createElement","render","Popup","setDOMContent","setLngLat","addTo","formPopup","user","console","log","Date","toLocaleDateString","axiosStart","performance","now","get","then","resp","axiosEnd","features","uniqueStart","data","forEach","d","type","properties","weight","timestamp","name","year","major","activity","roommate","contact","email","attention","geometry","coordinates","uniqueEnd","groupStart","locCache","Set","groupedFeatures","groupI","Object","values","e","long","found","c","oldUserList","oldGeometry","oldWeight","oldAttention","some","a","push","add","groupEnd","userCollection","mapStart","Map","container","style","center","addSource","addLayer","id","source","maxzoom","paint","stops","default","minzoom","property","myComp","JSON","parse","mapEnd","displayUsers","usersLookingForRoommate","entries","filter","entry","options","keys","location","userData","marginBottom","marginRight","margin","overlay","modal","option","value","params","props","color","val","flyTo","myPopup"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport ReactDOM from \"react-dom\";\n// eslint-disable-next-line\nimport mapboxgl from \"!mapbox-gl\";\nimport axios from \"axios\";\nimport Button from \"@mui/material/Button\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Autocomplete from \"@mui/material/Autocomplete\";\nimport TextField from \"@mui/material/TextField\";\nimport { ThemeProvider, createTheme } from \"@mui/material/styles\";\nimport { deepPurple } from \"@mui/material/colors\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\n// import ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport \"react-responsive-modal/styles.css\";\nimport { Modal } from \"react-responsive-modal\";\nimport \"./App.css\";\n\nmapboxgl.accessToken = \"pk.eyJ1IjoiaWFua2hvdSIsImEiOiJja3U1enMzNHE0enN4Mm9waXNwcDlyeGVpIn0.gz1TKA2H5JfDkMiHkdVxRQ\";\n\nexport default function App() {\n\t// update users from Google Sheet\n\tconst mapContainer = useRef(null);\n\tconst map = useRef(null);\n\tconst [users, setUsers] = useState(null);\n\tconst [lng, setLng] = useState(-98.0822);\n\tconst [lat, setLat] = useState(39.6719);\n\tconst [zoom, setZoom] = useState(3);\n\tconst [search, setSearch] = useState(false);\n\tconst [displayRoommates, setDisplayRoommates] = useState(false);\n\n\tconst theme = createTheme({\n\t\tpalette: {\n\t\t\tmode: \"dark\",\n\t\t\tprimary: {\n\t\t\t  main: deepPurple[400],\n\t\t\t},\n\t\t  },\n\t  });\n\n\tuseEffect(() => {\n\t\tif (!map.current) return; // wait for map to initialize\n\t\tmap.current.on(\"move\", () => {\n\t\t\tsetLng(map.current.getCenter().lng.toFixed(4));\n\t\t\tsetLat(map.current.getCenter().lat.toFixed(4));\n\t\t\tsetZoom(map.current.getZoom().toFixed(2));\n\t\t});\n\t});\n\n\tfunction addPopup(el, coords) {\n\t\tconst placeholder = document.createElement(\"div\");\n\t\tReactDOM.render(el, placeholder);\n  \n\t\tnew mapboxgl.Popup()\n\t\t\t.setDOMContent(placeholder)\n\t\t\t.setLngLat(coords)\n\t\t\t.addTo(map.current);\n\t}\n\n\tconst formPopup = (users) => {\n\t\treturn <div>\n\t\t\t{users.map((user) => {\n\t\t\t\tconsole.log(user);\n\t\t\t\treturn <div className=\"user-container\" key={`USER_INFO_BOX_FOR_${user[\"email\"]}`}>\n\t\t\t\t\t<h1>{`${user[\"name\"]} '${user[\"year\"]}`}</h1>\n\t\t\t\t\t{user[\"roommate\"] ? <h3><b>Looking for a house/roommate</b></h3> : null}\n\t\t\t\t\t<p>Major(s): {user[\"major\"]}</p>\n\t\t\t\t\t<p>What I&apos;m doing here: {user[\"activity\"]}</p>\n\t\t\t\t\t{user[\"contact\"] ? <p>Contact: {user[\"contact\"]}</p> : null}\n\t\t\t\t\t<p>Last updated: {new Date(user[\"timestamp\"]).toLocaleDateString()}</p>\n\t\t\t\t</div>;\n\t\t\t}\n\t\t\t) }\n\t\t</div>;\n\t};\n\n\tuseEffect(() => {\n\t\tif (users) return;\n\t\tconst axiosStart = performance.now();\n\t\taxios.get(\"https://script.google.com/macros/s/AKfycbw4H4dqvK6b4iIW_RkF80__SzI3bpCi0k6-OxQdv2-utpXJbcTY8d_KsdIOS-BSfEENxg/exec\")\n\n\t\t\t.then((resp) => {\n\t\t\t\tconst axiosEnd = performance.now();\n\t\t\t\tconsole.log(`Axios call took ${axiosEnd - axiosStart} milliseconds`);\n        \n\t\t\t\tconst features = {};\n\n\t\t\t\tconst uniqueStart = performance.now();\n\t\t\t\tresp.data.forEach((d) => {          \n\t\t\t\t\tfeatures[d[\"Email Address\"]] =  {\n\t\t\t\t\t\ttype: \"Feature\",\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\tweight: 1,\n\t\t\t\t\t\t\tusers: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttimestamp: d[\"Timestamp\"],\n\t\t\t\t\t\t\t\t\tname: d[\"Name (First Last)\"],\n\t\t\t\t\t\t\t\t\tyear: d[\"Year\"],\n\t\t\t\t\t\t\t\t\tmajor: d[\"Major(s)\"],\n\t\t\t\t\t\t\t\t\tactivity: d[\"What will you be doing there (ex. Working at McDonalds as a Software Engineer)?\"],\n\t\t\t\t\t\t\t\t\troommate: d[\"Are you looking for a house/roommate?\"] == \"Yes\" ? true : false,\n\t\t\t\t\t\t\t\t\tcontact: d[\"Contact information\"],\n\t\t\t\t\t\t\t\t\temail: d[\"Email Address\"]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tattention: d[\"Are you looking for a house/roommate?\"] == \"Yes\" ? 1 : 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgeometry: {\n\t\t\t\t\t\t\ttype: \"Point\",\n\t\t\t\t\t\t\tcoordinates: [\n\t\t\t\t\t\t\t\td[\"Longitude\"], d[\"Latitude\"]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\tsetUsers(features);\n\n\t\t\t\tconst uniqueEnd = performance.now();\n\n\t\t\t\tconsole.log(`Eliminating duplicate records took ${uniqueEnd - uniqueStart} milliseconds`);\n        \n\t\t\t\tconst groupStart = performance.now();\n\n\t\t\t\t// set contains coordinates [long, lat]\n\t\t\t\tconst locCache = new Set();\n\n\t\t\t\tconst groupedFeatures = [];\n\t\t\t\tlet groupI = 0;\n\n\t\t\t\t// map through each user\n\t\t\t\tObject.values(features).forEach((e) => {\n\t\t\t\t\tconst long = e[\"geometry\"][\"coordinates\"][0];\n\t\t\t\t\tconst lat = e[\"geometry\"][\"coordinates\"][1];\n\t\t\t\t\tlet found = false;\n\n\t\t\t\t\t// forEach through the cache and check for similar loc\n\t\t\t\t\tlocCache.forEach(c => {\n\t\t\t\t\t\t// if sim loc, group into the first occurrence\n\t\t\t\t\t\tif ((long - c[0]) ** 2 + (lat - c[1]) ** 2 < 0.001 ** 2) {\n\t\t\t\t\t\t\t// append to prev user list, inc weight, keep geometry\n              \n\t\t\t\t\t\t\tconst oldUserList = groupedFeatures[c[2]][\"properties\"][\"users\"];\n\t\t\t\t\t\t\tconst oldGeometry = groupedFeatures[c[2]][\"geometry\"];\n\t\t\t\t\t\t\tconst oldWeight = groupedFeatures[c[2]][\"properties\"][\"weight\"];\n\t\t\t\t\t\t\tconst oldAttention = groupedFeatures[c[2]][\"properties\"][\"attention\"];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tgroupedFeatures[c[2]] = {\n\t\t\t\t\t\t\t\ttype: \"Feature\",\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tweight: oldWeight + 1,\n\t\t\t\t\t\t\t\t\tusers: [...oldUserList, e[\"properties\"][\"users\"][0]],\n\t\t\t\t\t\t\t\t\tattention: + [oldAttention, e[\"properties\"][\"attention\"]].some((a) => a === 1)\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tgeometry: oldGeometry\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t// if you've made it this far, there is not a match\n\t\t\t\t\t\t// push the uniquely-located user to the group\n\t\t\t\t\t\tgroupedFeatures.push(e);\n\t\t\t\t\t\t// cache their location and group index, increment group index\n\t\t\t\t\t\tlocCache.add([long, lat, groupI]);\n\t\t\t\t\t\tgroupI ++;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconst groupEnd = performance.now();\n\n\t\t\t\tconsole.log(`Grouping records took ${groupEnd - groupStart} milliseconds`);\n\n\t\t\t\tconst userCollection = {\n\t\t\t\t\ttype: \"FeatureCollection\",\n\t\t\t\t\tfeatures: groupedFeatures\n\t\t\t\t};\n\n\t\t\t\tif (map.current) return; // initialize map only once\n    \n\t\t\t\tconst mapStart = performance.now();\n\n\t\t\t\tmap.current = new mapboxgl.Map({\n\t\t\t\t\tcontainer: mapContainer.current,\n\t\t\t\t\tstyle: \"mapbox://styles/mapbox/dark-v10\",\n\t\t\t\t\tcenter: [lng, lat],\n\t\t\t\t\tzoom: zoom\n\t\t\t\t});\n    \n\t\t\t\tmap.current.on(\"load\", () => {\n\t\t\t\t\tmap.current.addSource(\"users\", {\n\t\t\t\t\t\ttype: \"geojson\",\n\t\t\t\t\t\tdata: userCollection\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.current.addLayer(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"users-heat\",\n\t\t\t\t\t\t\ttype: \"heatmap\",\n\t\t\t\t\t\t\tsource: \"users\",\n\t\t\t\t\t\t\tmaxzoom: 14,\n\t\t\t\t\t\t\tpaint: {\n\t\t\t\t\t\t\t\t// increase weight as diameter breast height increases\n\t\t\t\t\t\t\t\t\"heatmap-weight\": {\n\t\t\t\t\t\t\t\t\ttype: \"exponential\",\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[1, 0],\n\t\t\t\t\t\t\t\t\t\t[500, 30],\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t// increase intensity as zoom level increases\n\t\t\t\t\t\t\t\t\"heatmap-intensity\": {\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[11, 1],\n\t\t\t\t\t\t\t\t\t\t[15, 3]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t// assign color values to points depending on their density\n\t\t\t\t\t\t\t\t\"heatmap-color\": [\n\t\t\t\t\t\t\t\t\t\"interpolate\",\n\t\t\t\t\t\t\t\t\t[\"linear\"],\n\t\t\t\t\t\t\t\t\t[\"heatmap-density\"],\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\"rgba(255,153,153,0)\",\n\t\t\t\t\t\t\t\t\t0.2,\n\t\t\t\t\t\t\t\t\t\"rgb(0,255,150)\",\n\t\t\t\t\t\t\t\t\t0.4,\n\t\t\t\t\t\t\t\t\t\"rgb(50,204,0)\",\n\t\t\t\t\t\t\t\t\t0.6,\n\t\t\t\t\t\t\t\t\t\"rgb(50,153,0)\",\n\t\t\t\t\t\t\t\t\t0.8,\n\t\t\t\t\t\t\t\t\t\"rgb(50,102,0)\"\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t// increase radius as zoom increases\n\t\t\t\t\t\t\t\t\"heatmap-radius\": {stops: [[11, 15],[15, 20]]},\n\t\t\t\t\t\t\t\t// decrease opacity to transition into the circle layer\n\t\t\t\t\t\t\t\t\"heatmap-opacity\": {\n\t\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[11, 1],\n\t\t\t\t\t\t\t\t\t\t[12, 0]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"waterway-label\"\n\t\t\t\t\t);\n\n\t\t\t\t\tmap.current.addLayer(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"users-point\",\n\t\t\t\t\t\t\ttype: \"circle\",\n\t\t\t\t\t\t\tsource: \"users\",\n\t\t\t\t\t\t\tminzoom: 5,\n\t\t\t\t\t\t\tpaint: {\n\t\t\t\t\t\t\t\t// increase the radius of the circle as the zoom level and weight increases\n\t\t\t\t\t\t\t\t\"circle-radius\": 8,\n\t\t\t\t\t\t\t\t\"circle-color\": {\n\t\t\t\t\t\t\t\t\tproperty: \"attention\",\n\t\t\t\t\t\t\t\t\ttype: \"exponential\",\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[0, \"rgb(0,225,0)\"],\n\t\t\t\t\t\t\t\t\t\t[1, \"rgb(255,200,0)\"]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\"circle-stroke-color\": \"rgba(0,100,0, 0.3)\",\n\t\t\t\t\t\t\t\t\"circle-stroke-width\": 1,\n\t\t\t\t\t\t\t\t\"circle-opacity\": {\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[11, 0],\n\t\t\t\t\t\t\t\t\t\t[12, 1]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"waterway-label\"\n\t\t\t\t\t);\n\n\t\t\t\t\tmap.current.on(\"click\", \"users-point\", ({ features }) => {\n\t\t\t\t\t\tconst { users } = features[0].properties;\n\t\t\t\t\t\tconst myComp = formPopup(JSON.parse(users));\n\t\t\t\t\t\taddPopup(myComp, features[0].geometry.coordinates);\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tconst mapEnd = performance.now();\n\t\t\t\t\n\t\t\t\tconsole.log(`Mapping records took ${mapEnd - mapStart} milliseconds`);\n\n\n\n\t\t\t});\n\t});\n\n\tconst displayUsers = () => {\n\t\tif (users) {\n\t\t\t// Filter for users looking for roommates\n\t\t\tconst usersLookingForRoommate = Object.entries(users).filter((entry) => {\n\t\t\t\treturn entry[1].properties.users[0].roommate === true;\n\t\t\t});\n\t\t\tconsole.log(usersLookingForRoommate);\n\t\t\treturn usersLookingForRoommate.map(([email, data]) => {\n\t\t\t\treturn (\n\t\t\t\t\t<div key={email} className=\"user-container\">\n\t\t\t\t\t\t<div>{data.properties.users[0].name}</div>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t});\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tlet options;\n\n\tif (users) {\n\t\toptions = Object.keys(users).map((email) => {\n\t\t\treturn {\n\t\t\t\temail,\n\t\t\t\tname: users[email].properties.users[0].name,\n\t\t\t\tyear: users[email].properties.users[0].year,\n\t\t\t\tlocation: users[email].geometry.coordinates,\n\t\t\t\tuserData: users[email].properties.users\n\t\t\t};\n\t\t});\n\t} else {\n\t\toptions = [];\n\t}\n\treturn (\n\t\t<div>\n\t\t\t<ThemeProvider theme={theme}>\n\n\t\t\t\t<div className=\"top_left\">\n\t\t\t\t\t<p style={{marginBottom: 5}}>Long: {lng} | Lat: {lat} | Zoom: {zoom}<br />Yellow dots need roommates (zoom in)<br />Add yourself to the map!</p>\n\t\t\t\t\n\t\t\t\t\t<Button style={{marginRight:10}} className=\"action_button\" size=\"small\" variant=\"outlined\" onClick={()=>setSearch(true)}>\n    search\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button className=\"action_button\" size=\"small\" variant=\"outlined\" href=\"https://docs.google.com/forms/d/e/1FAIpQLSeL_-gto_kwPpzbZCJaGejjlfbrLwmW1TqobfToT4AHlxPIGA/viewform?usp=sf_link\">\n    students\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button style={{ margin: 10 }} className=\"action_button\" size=\"small\" variant=\"outlined\" href=\"https://docs.google.com/forms/d/e/1FAIpQLSfN9_kXsE0C4RcdjWCGpTgGH4cwAgVoAeKLCxVW9voIYm4BLQ/viewform?usp=sf_link\">\n    alums\n\t\t\t\t\t</Button>\n\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div className=\"top_right\">\n\t\t\t\t\t<p>People looking for roommates:</p>\n\t\t\t\t\t{/* <div> */}\n\t\t\t\t\t{displayRoommates ? displayUsers():null}\n\t\t\t\t\t<IconButton aria-label=\"expand\" color=\"primary\" onClick={() => setDisplayRoommates(!displayRoommates)}>\n\t\t\t\t\t\t<ExpandMoreIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t{/* </div> */}\n\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</ThemeProvider>\n\t\t\t<div ref={mapContainer} className=\"map-container\" />\n\t\t\t<Modal center \n\t\t\t\tclassNames={{\n\t\t\t\t\toverlay: \"customOverlay\",\n\t\t\t\t\tmodal: \"customModal\",\n\t\t\t\t}}\n\t\t\t\topen={search} onClose={() => setSearch(false)}>\n\t\t\t\t<ThemeProvider theme={theme}>\n\t\t\t\t\t<Autocomplete \n\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\tisOptionEqualToValue={(option, value) => option.email === value.email}\n\t\t\t\t\t\tgetOptionLabel={(option) => option.name}\n\t\t\t\t\t\tautoComplete\n\t\t\t\t\t\trenderInput={(params) => <TextField {...params} label=\"Search\" />}\n\t\t\t\t\t\trenderOption={(props, option) => <li {...props} key={option.email}>{option.name} (&lsquo;{option.year})</li>}\n\t\t\t\t\t\tsx={{color: \"black\"}}\n\t\t\t\t\t\tonChange={(e, val) => {\n\t\t\t\t\t\t\tsetSearch(false);\n\t\t\t\t\t\t\tmap.current.flyTo(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcenter: val.location,\n\t\t\t\t\t\t\t\t\tzoom: 13\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst myPopup = formPopup(val.userData);\n\t\t\t\t\t\t\taddPopup(myPopup, val.location);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\t\n\t\t\t\t\t/>\n\t\t\t\t</ThemeProvider>\n\t\t\t</Modal>\n\t\t</div>\n\n\t);\n}"]},"metadata":{},"sourceType":"module"}