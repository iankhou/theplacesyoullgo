{"ast":null,"code":"import _objectSpread from\"/Users/ikh/localdev/otpyg/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/ikh/localdev/otpyg/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/ikh/localdev/otpyg/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useEffect,useState}from\"react\";import ReactDOM from\"react-dom\";// eslint-disable-next-line\nimport mapboxgl from\"!mapbox-gl\";import axios from\"axios\";import Button from\"@mui/material/Button\";import Autocomplete from\"@mui/material/Autocomplete\";import TextField from\"@mui/material/TextField\";import{ThemeProvider,createTheme}from\"@mui/material/styles\";import\"react-responsive-modal/styles.css\";import{Modal}from\"react-responsive-modal\";import\"./App.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";mapboxgl.accessToken=\"pk.eyJ1IjoiaWFua2hvdSIsImEiOiJja3U1enMzNHE0enN4Mm9waXNwcDlyeGVpIn0.gz1TKA2H5JfDkMiHkdVxRQ\";export default function App(){// update users from Google Sheet\nvar mapContainer=useRef(null);var map=useRef(null);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState(-98.0822),_useState4=_slicedToArray(_useState3,2),lng=_useState4[0],setLng=_useState4[1];var _useState5=useState(39.6719),_useState6=_slicedToArray(_useState5,2),lat=_useState6[0],setLat=_useState6[1];var _useState7=useState(3),_useState8=_slicedToArray(_useState7,2),zoom=_useState8[0],setZoom=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),search=_useState10[0],setSearch=_useState10[1];var theme=createTheme({palette:{type:\"dark\"}});useEffect(function(){if(!map.current)return;// wait for map to initialize\nmap.current.on(\"move\",function(){setLng(map.current.getCenter().lng.toFixed(4));setLat(map.current.getCenter().lat.toFixed(4));setZoom(map.current.getZoom().toFixed(2));});});function addPopup(el,coords){var placeholder=document.createElement(\"div\");ReactDOM.render(el,placeholder);new mapboxgl.Popup().setDOMContent(placeholder).setLngLat(coords).addTo(map.current);}var formPopup=function formPopup(users){return/*#__PURE__*/_jsx(\"div\",{children:users.map(function(user){return/*#__PURE__*/_jsxs(\"div\",{className:\"user-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\".concat(user[\"name\"],\" '\").concat(user[\"year\"])}),user[\"roommate\"]?/*#__PURE__*/_jsx(\"h3\",{children:/*#__PURE__*/_jsx(\"b\",{children:\"Looking for a house/roommate\"})}):null,/*#__PURE__*/_jsxs(\"p\",{children:[\"Major(s): \",user[\"major\"]]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"What I'm doing here: \",user[\"activity\"]]}),user[\"contact\"]?/*#__PURE__*/_jsxs(\"p\",{children:[\"Contact: \",user[\"contact\"]]}):null,/*#__PURE__*/_jsxs(\"p\",{children:[\"Last updated: \",new Date(user[\"timestamp\"]).toLocaleDateString()]})]},\"USER_INFO_BOX_FOR_\".concat(user[\"email\"]));})});};useEffect(function(){if(users)return;var axiosStart=performance.now();axios.get(\"https://script.google.com/macros/s/AKfycbw4H4dqvK6b4iIW_RkF80__SzI3bpCi0k6-OxQdv2-utpXJbcTY8d_KsdIOS-BSfEENxg/exec\").then(function(resp){var axiosEnd=performance.now();console.log(\"Axios call took \".concat(axiosEnd-axiosStart,\" milliseconds\"));// setUsers(resp.data);\nvar features={};var uniqueStart=performance.now();resp.data.forEach(function(d){features[d[\"Email Address\"]]={type:\"Feature\",properties:{weight:1,users:[{timestamp:d[\"Timestamp\"],name:d[\"Name (First Last)\"],year:d[\"Year\"],major:d[\"Major(s)\"],activity:d[\"What will you be doing there (work, school, etc.)?\"],roommate:d[\"Are you looking for a house/roommate?\"]==\"Yes\"?true:false,contact:d[\"Contact information\"],email:d[\"Email Address\"]}],attention:d[\"Are you looking for a house/roommate?\"]==\"Yes\"?1:0},geometry:{type:\"Point\",coordinates:[d[\"Longitude\"],d[\"Latitude\"]]}};});// console.log(features);\nsetUsers(features);var uniqueEnd=performance.now();console.log(\"Eliminating duplicate records took \".concat(uniqueEnd-uniqueStart,\" milliseconds\"));var groupStart=performance.now();// set contains coordinates [long, lat]\nvar locCache=new Set();var groupedFeatures=[];var groupI=0;// map through each user\nObject.values(features).forEach(function(e){var long=e[\"geometry\"][\"coordinates\"][0];var lat=e[\"geometry\"][\"coordinates\"][1];var found=false;// forEach through the cache and check for similar loc\nlocCache.forEach(function(c){// if sim loc, group into the first occurrence\nif(Math.pow(long-c[0],2)+Math.pow(lat-c[1],2)<Math.pow(0.001,2)){// append to prev user list, inc weight, keep geometry\nvar oldUserList=groupedFeatures[c[2]][\"properties\"][\"users\"];var oldGeometry=groupedFeatures[c[2]][\"geometry\"];var oldWeight=groupedFeatures[c[2]][\"properties\"][\"weight\"];var oldAttention=groupedFeatures[c[2]][\"properties\"][\"attention\"];groupedFeatures[c[2]]={type:\"Feature\",properties:{weight:oldWeight+1,users:[].concat(_toConsumableArray(oldUserList),[e[\"properties\"][\"users\"][0]]),attention:+[oldAttention,e[\"properties\"][\"attention\"]].some(function(a){return a===1;})},geometry:oldGeometry};found=true;}});if(!found){// if you've made it this far, there is not a match\n// push the uniquely-located user to the group\ngroupedFeatures.push(e);// cache their location and group index, increment group index\nlocCache.add([long,lat,groupI]);groupI++;}});var groupEnd=performance.now();console.log(\"Grouping records took \".concat(groupEnd-groupStart,\" milliseconds\"));var userCollection={type:\"FeatureCollection\",features:groupedFeatures};if(map.current)return;// initialize map only once\nvar mapStart=performance.now();map.current=new mapboxgl.Map({container:mapContainer.current,style:\"mapbox://styles/mapbox/dark-v10\",center:[lng,lat],zoom:zoom});map.current.on(\"load\",function(){map.current.addSource(\"users\",{type:\"geojson\",data:userCollection});map.current.addLayer({id:\"users-heat\",type:\"heatmap\",source:\"users\",maxzoom:14,paint:{// increase weight as diameter breast height increases\n\"heatmap-weight\":{type:\"exponential\",stops:[[1,0],[500,30]]},// increase intensity as zoom level increases\n\"heatmap-intensity\":{stops:[[11,1],[15,3]]},// assign color values to points depending on their density\n\"heatmap-color\":[\"interpolate\",[\"linear\"],[\"heatmap-density\"],0,\"rgba(255,153,153,0)\",0.2,\"rgb(0,255,150)\",0.4,\"rgb(50,204,0)\",0.6,\"rgb(50,153,0)\",0.8,\"rgb(50,102,0)\"],// increase radius as zoom increases\n\"heatmap-radius\":{stops:[[11,15],[15,20]]},// decrease opacity to transition into the circle layer\n\"heatmap-opacity\":{default:1,stops:[[11,1],[12,0]]}}},\"waterway-label\");map.current.addLayer({id:\"users-point\",type:\"circle\",source:\"users\",minzoom:5,paint:{// increase the radius of the circle as the zoom level and weight increases\n// \"circle-radius\": {property: \"weight\",type: \"exponential\",stops: [[{ zoom: 15, value: 1 }, 20],[{ zoom: 15, value: 62 }, 40],[{ zoom: 22, value: 1 }, 80],[{ zoom: 22, value: 62 }, 200]]},\n\"circle-radius\":8,// \"circle-color\": \"rgb(0,255,0)\",\n\"circle-color\":{property:\"attention\",type:\"exponential\",stops:[[0,\"rgb(0,225,0)\"],[1,\"rgb(255,200,0)\"]]},\"circle-stroke-color\":\"rgba(0,100,0, 0.3)\",\"circle-stroke-width\":1,\"circle-opacity\":{stops:[[11,0],[12,1]]}}},\"waterway-label\");map.current.on(\"click\",\"users-point\",function(_ref){var features=_ref.features;var users=features[0].properties.users;console.log(typeof JSON.parse(users)[0][\"timestamp\"],JSON.parse(users)[0][\"timestamp\"]);var myComp=formPopup(JSON.parse(users));// (\n// \t<div>\n// \t\t{JSON.parse(users).map((user) =>\n// \t\t\t<div className=\"user-container\" key={`USER_INFO_BOX_FOR_${user[\"email\"]}`}>\n// \t\t\t\t<h1>{`${user[\"name\"]} '${user[\"year\"]}`}</h1>\n// \t\t\t\t{user[\"roommate\"] ? <h3><b>Looking for a house/roommate</b></h3> : null}\n// \t\t\t\t<p>Major(s): {user[\"major\"]}</p>\n// \t\t\t\t<p>What I&apos;m doing here: {user[\"activity\"]}</p>\n// \t\t\t\t{user[\"contact\"] ? <p>Contact: {user[\"contact\"]}</p> : null}\n// \t\t\t\t<p>Last updated: {new Date(user[\"timestamp\"]).toLocaleDateString()}</p>\n// \t\t\t</div>) }\n// \t</div>\n// );\naddPopup(myComp,features[0].geometry.coordinates);});});var mapEnd=performance.now();console.log(\"Mapping records took \".concat(mapEnd-mapStart,\" milliseconds\"));});});var options;if(users){// console.log(users);\noptions=Object.keys(users).map(function(email){// console.log(email);\nreturn{email:email,name:users[email].properties.users[0].name,location:users[email].geometry.coordinates,userData:users[email].properties.users};});}else{options=[];}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Long: \",lng,\" | Lat: \",lat,\" | Zoom: \",zoom]}),/*#__PURE__*/_jsx(\"p\",{children:\"Zoom in to see roommate seekers!\"}),/*#__PURE__*/_jsx(Button,{style:{marginRight:10},className:\"action_button\",size:\"small\",variant:\"outlined\",onClick:function onClick(){return setSearch(true);},children:\"search\"}),/*#__PURE__*/_jsx(Button,{className:\"action_button\",size:\"small\",variant:\"outlined\",href:\"https://docs.google.com/forms/d/e/1FAIpQLSeL_-gto_kwPpzbZCJaGejjlfbrLwmW1TqobfToT4AHlxPIGA/viewform?usp=sf_link\",children:\"students\"}),/*#__PURE__*/_jsx(Button,{style:{margin:10},className:\"action_button\",size:\"small\",variant:\"outlined\",href:\"https://docs.google.com/forms/d/e/1FAIpQLSfN9_kXsE0C4RcdjWCGpTgGH4cwAgVoAeKLCxVW9voIYm4BLQ/viewform?usp=sf_link\",children:\"alums\"}),/*#__PURE__*/_jsx(Modal,{center:true,classNames:{overlay:\"customOverlay\",modal:\"customModal\"},open:search,onClose:function onClose(){return setSearch(false);},children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsx(Autocomplete,{options:options// renderOption={(props, option)=>{\n// \tconsole.log(option);\n// \treturn (\n// \t\t<li {...props} key={option.email}>\n// \t\t\t{option.name}\n// \t\t</li>\n// \t);\n// }\n// }\n,isOptionEqualToValue:function isOptionEqualToValue(option,value){return option.email===value.email;},getOptionLabel:function getOptionLabel(option){return option.name;},autoComplete:true,renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Search\"}));},sx:{color:\"black\"},onChange:function onChange(e,val){// console.log(val);\n// console.log(users);\nsetSearch(false);// console.log(map);\n// console.log(val);\nmap.current.flyTo({center:val.location,zoom:13});console.log(val.userData);var myPopup=formPopup(val.userData);console.log(myPopup);addPopup(myPopup,val.location);}})})})]}),/*#__PURE__*/_jsx(\"div\",{ref:mapContainer,className:\"map-container\"})]});}","map":{"version":3,"sources":["/Users/ikh/localdev/otpyg/src/App.js"],"names":["React","useRef","useEffect","useState","ReactDOM","mapboxgl","axios","Button","Autocomplete","TextField","ThemeProvider","createTheme","Modal","accessToken","App","mapContainer","map","users","setUsers","lng","setLng","lat","setLat","zoom","setZoom","search","setSearch","theme","palette","type","current","on","getCenter","toFixed","getZoom","addPopup","el","coords","placeholder","document","createElement","render","Popup","setDOMContent","setLngLat","addTo","formPopup","user","Date","toLocaleDateString","axiosStart","performance","now","get","then","resp","axiosEnd","console","log","features","uniqueStart","data","forEach","d","properties","weight","timestamp","name","year","major","activity","roommate","contact","email","attention","geometry","coordinates","uniqueEnd","groupStart","locCache","Set","groupedFeatures","groupI","Object","values","e","long","found","c","oldUserList","oldGeometry","oldWeight","oldAttention","some","a","push","add","groupEnd","userCollection","mapStart","Map","container","style","center","addSource","addLayer","id","source","maxzoom","paint","stops","default","minzoom","property","JSON","parse","myComp","mapEnd","options","keys","location","userData","marginRight","margin","overlay","modal","option","value","params","color","val","flyTo","myPopup"],"mappings":"ubAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,SAAxB,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA;AACA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,4BAAzB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,OAASC,aAAT,CAAwBC,WAAxB,KAA2C,sBAA3C,CACA,MAAO,mCAAP,CACA,OAASC,KAAT,KAAsB,wBAAtB,CACA,MAAO,WAAP,C,wFAEAP,QAAQ,CAACQ,WAAT,CAAuB,2FAAvB,CAEA,cAAe,SAASC,CAAAA,GAAT,EAAe,CAC7B;AACA,GAAMC,CAAAA,YAAY,CAAGd,MAAM,CAAC,IAAD,CAA3B,CACA,GAAMe,CAAAA,GAAG,CAAGf,MAAM,CAAC,IAAD,CAAlB,CAH6B,cAIHE,QAAQ,CAAC,IAAD,CAJL,wCAItBc,KAJsB,eAIfC,QAJe,8BAKPf,QAAQ,CAAC,CAAC,OAAF,CALD,yCAKtBgB,GALsB,eAKjBC,MALiB,8BAMPjB,QAAQ,CAAC,OAAD,CAND,yCAMtBkB,GANsB,eAMjBC,MANiB,8BAOLnB,QAAQ,CAAC,CAAD,CAPH,yCAOtBoB,IAPsB,eAOhBC,OAPgB,8BAQDrB,QAAQ,CAAC,KAAD,CARP,0CAQtBsB,MARsB,gBAQdC,SARc,gBAS7B,GAAMC,CAAAA,KAAK,CAAGhB,WAAW,CAAC,CACzBiB,OAAO,CAAE,CACPC,IAAI,CAAE,MADC,CADgB,CAAD,CAAzB,CAMA3B,SAAS,CAAC,UAAM,CACf,GAAI,CAACc,GAAG,CAACc,OAAT,CAAkB,OAAQ;AAC1Bd,GAAG,CAACc,OAAJ,CAAYC,EAAZ,CAAe,MAAf,CAAuB,UAAM,CAC5BX,MAAM,CAACJ,GAAG,CAACc,OAAJ,CAAYE,SAAZ,GAAwBb,GAAxB,CAA4Bc,OAA5B,CAAoC,CAApC,CAAD,CAAN,CACAX,MAAM,CAACN,GAAG,CAACc,OAAJ,CAAYE,SAAZ,GAAwBX,GAAxB,CAA4BY,OAA5B,CAAoC,CAApC,CAAD,CAAN,CACAT,OAAO,CAACR,GAAG,CAACc,OAAJ,CAAYI,OAAZ,GAAsBD,OAAtB,CAA8B,CAA9B,CAAD,CAAP,CACA,CAJD,EAKA,CAPQ,CAAT,CASA,QAASE,CAAAA,QAAT,CAAkBC,EAAlB,CAAsBC,MAAtB,CAA8B,CAC7B,GAAMC,CAAAA,WAAW,CAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAApB,CACApC,QAAQ,CAACqC,MAAT,CAAgBL,EAAhB,CAAoBE,WAApB,EAEA,GAAIjC,CAAAA,QAAQ,CAACqC,KAAb,GACEC,aADF,CACgBL,WADhB,EAEEM,SAFF,CAEYP,MAFZ,EAGEQ,KAHF,CAGQ7B,GAAG,CAACc,OAHZ,EAIA,CAED,GAAMgB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAC7B,KAAD,CAAW,CAC5B,mBAAO,qBACLA,KAAK,CAACD,GAAN,CAAU,SAAC+B,IAAD,qBACV,aAAK,SAAS,CAAC,gBAAf,wBACC,8BAAQA,IAAI,CAAC,MAAD,CAAZ,cAAyBA,IAAI,CAAC,MAAD,CAA7B,GADD,CAEEA,IAAI,CAAC,UAAD,CAAJ,cAAmB,iCAAI,mDAAJ,EAAnB,CAAkE,IAFpE,cAGC,kCAAcA,IAAI,CAAC,OAAD,CAAlB,GAHD,cAIC,6CAA8BA,IAAI,CAAC,UAAD,CAAlC,GAJD,CAKEA,IAAI,CAAC,SAAD,CAAJ,cAAkB,iCAAaA,IAAI,CAAC,SAAD,CAAjB,GAAlB,CAAsD,IALxD,cAMC,sCAAkB,GAAIC,CAAAA,IAAJ,CAASD,IAAI,CAAC,WAAD,CAAb,EAA4BE,kBAA5B,EAAlB,GAND,+BAA0DF,IAAI,CAAC,OAAD,CAA9D,EADU,EAAV,CADK,EAAP,CAWA,CAZD,CAcA7C,SAAS,CAAC,UAAM,CACf,GAAIe,KAAJ,CAAW,OACX,GAAMiC,CAAAA,UAAU,CAAGC,WAAW,CAACC,GAAZ,EAAnB,CACA9C,KAAK,CAAC+C,GAAN,CAAU,oHAAV,EAEEC,IAFF,CAEO,SAACC,IAAD,CAAU,CACf,GAAMC,CAAAA,QAAQ,CAAGL,WAAW,CAACC,GAAZ,EAAjB,CACAK,OAAO,CAACC,GAAR,2BAA+BF,QAAQ,CAAGN,UAA1C,mBAEA;AAEA,GAAMS,CAAAA,QAAQ,CAAG,EAAjB,CAEA,GAAMC,CAAAA,WAAW,CAAGT,WAAW,CAACC,GAAZ,EAApB,CAEAG,IAAI,CAACM,IAAL,CAAUC,OAAV,CAAkB,SAACC,CAAD,CAAO,CACxBJ,QAAQ,CAACI,CAAC,CAAC,eAAD,CAAF,CAAR,CAAgC,CAC/BlC,IAAI,CAAE,SADyB,CAE/BmC,UAAU,CAAE,CACXC,MAAM,CAAE,CADG,CAEXhD,KAAK,CAAE,CACN,CACCiD,SAAS,CAAEH,CAAC,CAAC,WAAD,CADb,CAECI,IAAI,CAAEJ,CAAC,CAAC,mBAAD,CAFR,CAGCK,IAAI,CAAEL,CAAC,CAAC,MAAD,CAHR,CAICM,KAAK,CAAEN,CAAC,CAAC,UAAD,CAJT,CAKCO,QAAQ,CAAEP,CAAC,CAAC,oDAAD,CALZ,CAMCQ,QAAQ,CAAER,CAAC,CAAC,uCAAD,CAAD,EAA8C,KAA9C,CAAsD,IAAtD,CAA6D,KANxE,CAOCS,OAAO,CAAET,CAAC,CAAC,qBAAD,CAPX,CAQCU,KAAK,CAAEV,CAAC,CAAC,eAAD,CART,CADM,CAFI,CAcXW,SAAS,CAAEX,CAAC,CAAC,uCAAD,CAAD,EAA8C,KAA9C,CAAsD,CAAtD,CAA0D,CAd1D,CAFmB,CAkB/BY,QAAQ,CAAE,CACT9C,IAAI,CAAE,OADG,CAET+C,WAAW,CAAE,CACZb,CAAC,CAAC,WAAD,CADW,CACIA,CAAC,CAAC,UAAD,CADL,CAFJ,CAlBqB,CAAhC,CAyBA,CA1BD,EA2BA;AACA7C,QAAQ,CAACyC,QAAD,CAAR,CAEA,GAAMkB,CAAAA,SAAS,CAAG1B,WAAW,CAACC,GAAZ,EAAlB,CAEAK,OAAO,CAACC,GAAR,8CAAkDmB,SAAS,CAAGjB,WAA9D,mBAEA,GAAMkB,CAAAA,UAAU,CAAG3B,WAAW,CAACC,GAAZ,EAAnB,CAEA;AACA,GAAM2B,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,GAAJ,EAAjB,CAEA,GAAMC,CAAAA,eAAe,CAAG,EAAxB,CACA,GAAIC,CAAAA,MAAM,CAAG,CAAb,CAEA;AACAC,MAAM,CAACC,MAAP,CAAczB,QAAd,EAAwBG,OAAxB,CAAgC,SAACuB,CAAD,CAAO,CACtC,GAAMC,CAAAA,IAAI,CAAGD,CAAC,CAAC,UAAD,CAAD,CAAc,aAAd,EAA6B,CAA7B,CAAb,CACA,GAAMhE,CAAAA,GAAG,CAAGgE,CAAC,CAAC,UAAD,CAAD,CAAc,aAAd,EAA6B,CAA7B,CAAZ,CACA,GAAIE,CAAAA,KAAK,CAAG,KAAZ,CAEA;AACAR,QAAQ,CAACjB,OAAT,CAAiB,SAAA0B,CAAC,CAAI,CACrB;AACA,GAAI,SAACF,IAAI,CAAGE,CAAC,CAAC,CAAD,CAAT,CAAiB,CAAjB,WAAsBnE,GAAG,CAAGmE,CAAC,CAAC,CAAD,CAA7B,CAAqC,CAArC,WAAyC,KAAzC,CAAkD,CAAlD,CAAJ,CAAyD,CACxD;AAEA,GAAMC,CAAAA,WAAW,CAAGR,eAAe,CAACO,CAAC,CAAC,CAAD,CAAF,CAAf,CAAsB,YAAtB,EAAoC,OAApC,CAApB,CACA,GAAME,CAAAA,WAAW,CAAGT,eAAe,CAACO,CAAC,CAAC,CAAD,CAAF,CAAf,CAAsB,UAAtB,CAApB,CACA,GAAMG,CAAAA,SAAS,CAAGV,eAAe,CAACO,CAAC,CAAC,CAAD,CAAF,CAAf,CAAsB,YAAtB,EAAoC,QAApC,CAAlB,CACA,GAAMI,CAAAA,YAAY,CAAGX,eAAe,CAACO,CAAC,CAAC,CAAD,CAAF,CAAf,CAAsB,YAAtB,EAAoC,WAApC,CAArB,CAEAP,eAAe,CAACO,CAAC,CAAC,CAAD,CAAF,CAAf,CAAwB,CACvB3D,IAAI,CAAE,SADiB,CAEvBmC,UAAU,CAAE,CACXC,MAAM,CAAE0B,SAAS,CAAG,CADT,CAEX1E,KAAK,8BAAMwE,WAAN,GAAmBJ,CAAC,CAAC,YAAD,CAAD,CAAgB,OAAhB,EAAyB,CAAzB,CAAnB,EAFM,CAGXX,SAAS,CAAE,CAAE,CAACkB,YAAD,CAAeP,CAAC,CAAC,YAAD,CAAD,CAAgB,WAAhB,CAAf,EAA6CQ,IAA7C,CAAkD,SAACC,CAAD,QAAOA,CAAAA,CAAC,GAAK,CAAb,EAAlD,CAHF,CAFW,CAOvBnB,QAAQ,CAAEe,WAPa,CAAxB,CAUAH,KAAK,CAAG,IAAR,CACA,CACD,CAtBD,EAuBA,GAAI,CAACA,KAAL,CAAY,CACX;AACA;AACAN,eAAe,CAACc,IAAhB,CAAqBV,CAArB,EACA;AACAN,QAAQ,CAACiB,GAAT,CAAa,CAACV,IAAD,CAAOjE,GAAP,CAAY6D,MAAZ,CAAb,EACAA,MAAM,GACN,CAED,CAtCD,EAwCA,GAAMe,CAAAA,QAAQ,CAAG9C,WAAW,CAACC,GAAZ,EAAjB,CAEAK,OAAO,CAACC,GAAR,iCAAqCuC,QAAQ,CAAGnB,UAAhD,mBAEA,GAAMoB,CAAAA,cAAc,CAAG,CACtBrE,IAAI,CAAE,mBADgB,CAEtB8B,QAAQ,CAAEsB,eAFY,CAAvB,CAKA,GAAIjE,GAAG,CAACc,OAAR,CAAiB,OAAQ;AAEzB,GAAMqE,CAAAA,QAAQ,CAAGhD,WAAW,CAACC,GAAZ,EAAjB,CAEApC,GAAG,CAACc,OAAJ,CAAc,GAAIzB,CAAAA,QAAQ,CAAC+F,GAAb,CAAiB,CAC9BC,SAAS,CAAEtF,YAAY,CAACe,OADM,CAE9BwE,KAAK,CAAE,iCAFuB,CAG9BC,MAAM,CAAE,CAACpF,GAAD,CAAME,GAAN,CAHsB,CAI9BE,IAAI,CAAEA,IAJwB,CAAjB,CAAd,CAOAP,GAAG,CAACc,OAAJ,CAAYC,EAAZ,CAAe,MAAf,CAAuB,UAAM,CAC5Bf,GAAG,CAACc,OAAJ,CAAY0E,SAAZ,CAAsB,OAAtB,CAA+B,CAC9B3E,IAAI,CAAE,SADwB,CAE9BgC,IAAI,CAAEqC,cAFwB,CAA/B,EAKAlF,GAAG,CAACc,OAAJ,CAAY2E,QAAZ,CACC,CACCC,EAAE,CAAE,YADL,CAEC7E,IAAI,CAAE,SAFP,CAGC8E,MAAM,CAAE,OAHT,CAICC,OAAO,CAAE,EAJV,CAKCC,KAAK,CAAE,CACN;AACA,iBAAkB,CACjBhF,IAAI,CAAE,aADW,CAEjBiF,KAAK,CAAE,CACN,CAAC,CAAD,CAAI,CAAJ,CADM,CAEN,CAAC,GAAD,CAAM,EAAN,CAFM,CAFU,CAFZ,CASN;AACA,oBAAqB,CACpBA,KAAK,CAAE,CACN,CAAC,EAAD,CAAK,CAAL,CADM,CAEN,CAAC,EAAD,CAAK,CAAL,CAFM,CADa,CAVf,CAgBN;AACA,gBAAiB,CAChB,aADgB,CAEhB,CAAC,QAAD,CAFgB,CAGhB,CAAC,iBAAD,CAHgB,CAIhB,CAJgB,CAKhB,qBALgB,CAMhB,GANgB,CAOhB,gBAPgB,CAQhB,GARgB,CAShB,eATgB,CAUhB,GAVgB,CAWhB,eAXgB,CAYhB,GAZgB,CAahB,eAbgB,CAjBX,CAgCN;AACA,iBAAkB,CAACA,KAAK,CAAE,CAAC,CAAC,EAAD,CAAK,EAAL,CAAD,CAAU,CAAC,EAAD,CAAK,EAAL,CAAV,CAAR,CAjCZ,CAkCN;AACA,kBAAmB,CAClBC,OAAO,CAAE,CADS,CAElBD,KAAK,CAAE,CACN,CAAC,EAAD,CAAK,CAAL,CADM,CAEN,CAAC,EAAD,CAAK,CAAL,CAFM,CAFW,CAnCb,CALR,CADD,CAkDC,gBAlDD,EAqDA9F,GAAG,CAACc,OAAJ,CAAY2E,QAAZ,CACC,CACCC,EAAE,CAAE,aADL,CAEC7E,IAAI,CAAE,QAFP,CAGC8E,MAAM,CAAE,OAHT,CAICK,OAAO,CAAE,CAJV,CAKCH,KAAK,CAAE,CACN;AACA;AACA,gBAAiB,CAHX,CAIN;AACA,eAAgB,CACfI,QAAQ,CAAE,WADK,CAEfpF,IAAI,CAAE,aAFS,CAGfiF,KAAK,CAAE,CACN,CAAC,CAAD,CAAI,cAAJ,CADM,CAEN,CAAC,CAAD,CAAI,gBAAJ,CAFM,CAHQ,CALV,CAaN,sBAAuB,oBAbjB,CAcN,sBAAuB,CAdjB,CAeN,iBAAkB,CACjBA,KAAK,CAAE,CACN,CAAC,EAAD,CAAK,CAAL,CADM,CAEN,CAAC,EAAD,CAAK,CAAL,CAFM,CADU,CAfZ,CALR,CADD,CA6BC,gBA7BD,EAgCA9F,GAAG,CAACc,OAAJ,CAAYC,EAAZ,CAAe,OAAf,CAAwB,aAAxB,CAAuC,cAAkB,IAAf4B,CAAAA,QAAe,MAAfA,QAAe,IAChD1C,CAAAA,KADgD,CACtC0C,QAAQ,CAAC,CAAD,CAAR,CAAYK,UAD0B,CAChD/C,KADgD,CAExDwC,OAAO,CAACC,GAAR,CAAY,MAAOwD,CAAAA,IAAI,CAACC,KAAL,CAAWlG,KAAX,EAAkB,CAAlB,EAAqB,WAArB,CAAnB,CAAsDiG,IAAI,CAACC,KAAL,CAAWlG,KAAX,EAAkB,CAAlB,EAAqB,WAArB,CAAtD,EACA,GAAMmG,CAAAA,MAAM,CAAGtE,SAAS,CAACoE,IAAI,CAACC,KAAL,CAAWlG,KAAX,CAAD,CAAxB,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEAkB,QAAQ,CAACiF,MAAD,CAASzD,QAAQ,CAAC,CAAD,CAAR,CAAYgB,QAAZ,CAAqBC,WAA9B,CAAR,CACA,CAnBD,EAoBA,CA/GD,EAiHA,GAAMyC,CAAAA,MAAM,CAAGlE,WAAW,CAACC,GAAZ,EAAf,CAEAK,OAAO,CAACC,GAAR,gCAAoC2D,MAAM,CAAGlB,QAA7C,mBAIA,CA1OF,EA2OA,CA9OQ,CAAT,CA+OA,GAAImB,CAAAA,OAAJ,CAEA,GAAIrG,KAAJ,CAAW,CACV;AACAqG,OAAO,CAAGnC,MAAM,CAACoC,IAAP,CAAYtG,KAAZ,EAAmBD,GAAnB,CAAuB,SAACyD,KAAD,CAAW,CAC3C;AACA,MAAO,CACNA,KAAK,CAALA,KADM,CAENN,IAAI,CAAElD,KAAK,CAACwD,KAAD,CAAL,CAAaT,UAAb,CAAwB/C,KAAxB,CAA8B,CAA9B,EAAiCkD,IAFjC,CAGNqD,QAAQ,CAAEvG,KAAK,CAACwD,KAAD,CAAL,CAAaE,QAAb,CAAsBC,WAH1B,CAIN6C,QAAQ,CAAExG,KAAK,CAACwD,KAAD,CAAL,CAAaT,UAAb,CAAwB/C,KAJ5B,CAAP,CAMA,CARS,CAAV,CASA,CAXD,IAWO,CACNqG,OAAO,CAAG,EAAV,CACA,CACD,mBAEC,oCACC,aAAK,SAAS,CAAC,SAAf,wBACC,8BAAUnG,GAAV,YAAuBE,GAAvB,aAAqCE,IAArC,GADD,cAEC,uDAFD,cAIC,KAAC,MAAD,EAAQ,KAAK,CAAE,CAACmG,WAAW,CAAC,EAAb,CAAf,CAAiC,SAAS,CAAC,eAA3C,CAA2D,IAAI,CAAC,OAAhE,CAAwE,OAAO,CAAC,UAAhF,CAA2F,OAAO,CAAE,yBAAIhG,CAAAA,SAAS,CAAC,IAAD,CAAb,EAApG,oBAJD,cAOC,KAAC,MAAD,EAAQ,SAAS,CAAC,eAAlB,CAAkC,IAAI,CAAC,OAAvC,CAA+C,OAAO,CAAC,UAAvD,CAAkE,IAAI,CAAC,iHAAvE,sBAPD,cAUC,KAAC,MAAD,EAAQ,KAAK,CAAE,CAAEiG,MAAM,CAAE,EAAV,CAAf,CAA+B,SAAS,CAAC,eAAzC,CAAyD,IAAI,CAAC,OAA9D,CAAsE,OAAO,CAAC,UAA9E,CAAyF,IAAI,CAAC,iHAA9F,mBAVD,cAcC,KAAC,KAAD,EAAO,MAAM,KAAb,CACC,UAAU,CAAE,CACXC,OAAO,CAAE,eADE,CAEXC,KAAK,CAAE,aAFI,CADb,CAKC,IAAI,CAAEpG,MALP,CAKe,OAAO,CAAE,yBAAMC,CAAAA,SAAS,CAAC,KAAD,CAAf,EALxB,uBAMC,KAAC,aAAD,EAAe,KAAK,CAAEC,KAAtB,uBACC,KAAC,YAAD,EACC,OAAO,CAAE2F,OACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVD,CAWC,oBAAoB,CAAE,8BAACQ,MAAD,CAASC,KAAT,QAAmBD,CAAAA,MAAM,CAACrD,KAAP,GAAiBsD,KAAK,CAACtD,KAA1C,EAXvB,CAYC,cAAc,CAAE,wBAACqD,MAAD,QAAYA,CAAAA,MAAM,CAAC3D,IAAnB,EAZjB,CAaC,YAAY,KAbb,CAcC,WAAW,CAAE,qBAAC6D,MAAD,qBAAY,KAAC,SAAD,gCAAeA,MAAf,MAAuB,KAAK,CAAC,QAA7B,GAAZ,EAdd,CAeC,EAAE,CAAE,CAACC,KAAK,CAAE,OAAR,CAfL,CAgBC,QAAQ,CAAE,kBAAC5C,CAAD,CAAI6C,GAAJ,CAAY,CACtB;AACA;AACCxG,SAAS,CAAC,KAAD,CAAT,CACA;AACA;AACAV,GAAG,CAACc,OAAJ,CAAYqG,KAAZ,CACC,CACC5B,MAAM,CAAE2B,GAAG,CAACV,QADb,CAECjG,IAAI,CAAE,EAFP,CADD,EAMAkC,OAAO,CAACC,GAAR,CAAYwE,GAAG,CAACT,QAAhB,EACA,GAAMW,CAAAA,OAAO,CAAGtF,SAAS,CAACoF,GAAG,CAACT,QAAL,CAAzB,CACAhE,OAAO,CAACC,GAAR,CAAY0E,OAAZ,EACAjG,QAAQ,CAACiG,OAAD,CAAUF,GAAG,CAACV,QAAd,CAAR,CACA,CAhCF,EADD,EAND,EAdD,GADD,cAgEC,YAAK,GAAG,CAAEzG,YAAV,CAAwB,SAAS,CAAC,eAAlC,EAhED,GAFD,CAuEA","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport ReactDOM from \"react-dom\";\n// eslint-disable-next-line\nimport mapboxgl from \"!mapbox-gl\";\nimport axios from \"axios\";\nimport Button from \"@mui/material/Button\";\nimport Autocomplete from \"@mui/material/Autocomplete\";\nimport TextField from \"@mui/material/TextField\";\nimport { ThemeProvider, createTheme } from \"@mui/material/styles\";\nimport \"react-responsive-modal/styles.css\";\nimport { Modal } from \"react-responsive-modal\";\nimport \"./App.css\";\n\nmapboxgl.accessToken = \"pk.eyJ1IjoiaWFua2hvdSIsImEiOiJja3U1enMzNHE0enN4Mm9waXNwcDlyeGVpIn0.gz1TKA2H5JfDkMiHkdVxRQ\";\n\nexport default function App() {\n\t// update users from Google Sheet\n\tconst mapContainer = useRef(null);\n\tconst map = useRef(null);\n\tconst [users, setUsers] = useState(null);\n\tconst [lng, setLng] = useState(-98.0822);\n\tconst [lat, setLat] = useState(39.6719);\n\tconst [zoom, setZoom] = useState(3);\n\tconst [search, setSearch] = useState(false);\n\tconst theme = createTheme({\n\t\tpalette: {\n\t\t  type: \"dark\"\n\t\t},\n\t  });\n\n\tuseEffect(() => {\n\t\tif (!map.current) return; // wait for map to initialize\n\t\tmap.current.on(\"move\", () => {\n\t\t\tsetLng(map.current.getCenter().lng.toFixed(4));\n\t\t\tsetLat(map.current.getCenter().lat.toFixed(4));\n\t\t\tsetZoom(map.current.getZoom().toFixed(2));\n\t\t});\n\t});\n\n\tfunction addPopup(el, coords) {\n\t\tconst placeholder = document.createElement(\"div\");\n\t\tReactDOM.render(el, placeholder);\n  \n\t\tnew mapboxgl.Popup()\n\t\t\t.setDOMContent(placeholder)\n\t\t\t.setLngLat(coords)\n\t\t\t.addTo(map.current);\n\t}\n\n\tconst formPopup = (users) => {\n\t\treturn <div>\n\t\t\t{users.map((user) =>\n\t\t\t\t<div className=\"user-container\" key={`USER_INFO_BOX_FOR_${user[\"email\"]}`}>\n\t\t\t\t\t<h1>{`${user[\"name\"]} '${user[\"year\"]}`}</h1>\n\t\t\t\t\t{user[\"roommate\"] ? <h3><b>Looking for a house/roommate</b></h3> : null}\n\t\t\t\t\t<p>Major(s): {user[\"major\"]}</p>\n\t\t\t\t\t<p>What I&apos;m doing here: {user[\"activity\"]}</p>\n\t\t\t\t\t{user[\"contact\"] ? <p>Contact: {user[\"contact\"]}</p> : null}\n\t\t\t\t\t<p>Last updated: {new Date(user[\"timestamp\"]).toLocaleDateString()}</p>\n\t\t\t\t</div>) }\n\t\t</div>;\n\t};\n\n\tuseEffect(() => {\n\t\tif (users) return;\n\t\tconst axiosStart = performance.now();\n\t\taxios.get(\"https://script.google.com/macros/s/AKfycbw4H4dqvK6b4iIW_RkF80__SzI3bpCi0k6-OxQdv2-utpXJbcTY8d_KsdIOS-BSfEENxg/exec\")\n\n\t\t\t.then((resp) => {\n\t\t\t\tconst axiosEnd = performance.now();\n\t\t\t\tconsole.log(`Axios call took ${axiosEnd - axiosStart} milliseconds`);\n\n\t\t\t\t// setUsers(resp.data);\n        \n\t\t\t\tconst features = {};\n\n\t\t\t\tconst uniqueStart = performance.now();\n\t\t\t\t\n\t\t\t\tresp.data.forEach((d) => {          \n\t\t\t\t\tfeatures[d[\"Email Address\"]] =  {\n\t\t\t\t\t\ttype: \"Feature\",\n\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\tweight: 1,\n\t\t\t\t\t\t\tusers: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttimestamp: d[\"Timestamp\"],\n\t\t\t\t\t\t\t\t\tname: d[\"Name (First Last)\"],\n\t\t\t\t\t\t\t\t\tyear: d[\"Year\"],\n\t\t\t\t\t\t\t\t\tmajor: d[\"Major(s)\"],\n\t\t\t\t\t\t\t\t\tactivity: d[\"What will you be doing there (work, school, etc.)?\"],\n\t\t\t\t\t\t\t\t\troommate: d[\"Are you looking for a house/roommate?\"] == \"Yes\" ? true : false,\n\t\t\t\t\t\t\t\t\tcontact: d[\"Contact information\"],\n\t\t\t\t\t\t\t\t\temail: d[\"Email Address\"]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tattention: d[\"Are you looking for a house/roommate?\"] == \"Yes\" ? 1 : 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgeometry: {\n\t\t\t\t\t\t\ttype: \"Point\",\n\t\t\t\t\t\t\tcoordinates: [\n\t\t\t\t\t\t\t\td[\"Longitude\"], d[\"Latitude\"]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\t// console.log(features);\n\t\t\t\tsetUsers(features);\n\n\t\t\t\tconst uniqueEnd = performance.now();\n\n\t\t\t\tconsole.log(`Eliminating duplicate records took ${uniqueEnd - uniqueStart} milliseconds`);\n        \n\t\t\t\tconst groupStart = performance.now();\n\n\t\t\t\t// set contains coordinates [long, lat]\n\t\t\t\tconst locCache = new Set();\n\n\t\t\t\tconst groupedFeatures = [];\n\t\t\t\tlet groupI = 0;\n\n\t\t\t\t// map through each user\n\t\t\t\tObject.values(features).forEach((e) => {\n\t\t\t\t\tconst long = e[\"geometry\"][\"coordinates\"][0];\n\t\t\t\t\tconst lat = e[\"geometry\"][\"coordinates\"][1];\n\t\t\t\t\tlet found = false;\n\n\t\t\t\t\t// forEach through the cache and check for similar loc\n\t\t\t\t\tlocCache.forEach(c => {\n\t\t\t\t\t\t// if sim loc, group into the first occurrence\n\t\t\t\t\t\tif ((long - c[0]) ** 2 + (lat - c[1]) ** 2 < 0.001 ** 2) {\n\t\t\t\t\t\t\t// append to prev user list, inc weight, keep geometry\n              \n\t\t\t\t\t\t\tconst oldUserList = groupedFeatures[c[2]][\"properties\"][\"users\"];\n\t\t\t\t\t\t\tconst oldGeometry = groupedFeatures[c[2]][\"geometry\"];\n\t\t\t\t\t\t\tconst oldWeight = groupedFeatures[c[2]][\"properties\"][\"weight\"];\n\t\t\t\t\t\t\tconst oldAttention = groupedFeatures[c[2]][\"properties\"][\"attention\"];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tgroupedFeatures[c[2]] = {\n\t\t\t\t\t\t\t\ttype: \"Feature\",\n\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\tweight: oldWeight + 1,\n\t\t\t\t\t\t\t\t\tusers: [...oldUserList, e[\"properties\"][\"users\"][0]],\n\t\t\t\t\t\t\t\t\tattention: + [oldAttention, e[\"properties\"][\"attention\"]].some((a) => a === 1)\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tgeometry: oldGeometry\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!found) {\n\t\t\t\t\t\t// if you've made it this far, there is not a match\n\t\t\t\t\t\t// push the uniquely-located user to the group\n\t\t\t\t\t\tgroupedFeatures.push(e);\n\t\t\t\t\t\t// cache their location and group index, increment group index\n\t\t\t\t\t\tlocCache.add([long, lat, groupI]);\n\t\t\t\t\t\tgroupI ++;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconst groupEnd = performance.now();\n\n\t\t\t\tconsole.log(`Grouping records took ${groupEnd - groupStart} milliseconds`);\n\n\t\t\t\tconst userCollection = {\n\t\t\t\t\ttype: \"FeatureCollection\",\n\t\t\t\t\tfeatures: groupedFeatures\n\t\t\t\t};\n\n\t\t\t\tif (map.current) return; // initialize map only once\n    \n\t\t\t\tconst mapStart = performance.now();\n\n\t\t\t\tmap.current = new mapboxgl.Map({\n\t\t\t\t\tcontainer: mapContainer.current,\n\t\t\t\t\tstyle: \"mapbox://styles/mapbox/dark-v10\",\n\t\t\t\t\tcenter: [lng, lat],\n\t\t\t\t\tzoom: zoom\n\t\t\t\t});\n    \n\t\t\t\tmap.current.on(\"load\", () => {\n\t\t\t\t\tmap.current.addSource(\"users\", {\n\t\t\t\t\t\ttype: \"geojson\",\n\t\t\t\t\t\tdata: userCollection\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.current.addLayer(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"users-heat\",\n\t\t\t\t\t\t\ttype: \"heatmap\",\n\t\t\t\t\t\t\tsource: \"users\",\n\t\t\t\t\t\t\tmaxzoom: 14,\n\t\t\t\t\t\t\tpaint: {\n\t\t\t\t\t\t\t\t// increase weight as diameter breast height increases\n\t\t\t\t\t\t\t\t\"heatmap-weight\": {\n\t\t\t\t\t\t\t\t\ttype: \"exponential\",\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[1, 0],\n\t\t\t\t\t\t\t\t\t\t[500, 30],\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t// increase intensity as zoom level increases\n\t\t\t\t\t\t\t\t\"heatmap-intensity\": {\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[11, 1],\n\t\t\t\t\t\t\t\t\t\t[15, 3]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t// assign color values to points depending on their density\n\t\t\t\t\t\t\t\t\"heatmap-color\": [\n\t\t\t\t\t\t\t\t\t\"interpolate\",\n\t\t\t\t\t\t\t\t\t[\"linear\"],\n\t\t\t\t\t\t\t\t\t[\"heatmap-density\"],\n\t\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t\t\"rgba(255,153,153,0)\",\n\t\t\t\t\t\t\t\t\t0.2,\n\t\t\t\t\t\t\t\t\t\"rgb(0,255,150)\",\n\t\t\t\t\t\t\t\t\t0.4,\n\t\t\t\t\t\t\t\t\t\"rgb(50,204,0)\",\n\t\t\t\t\t\t\t\t\t0.6,\n\t\t\t\t\t\t\t\t\t\"rgb(50,153,0)\",\n\t\t\t\t\t\t\t\t\t0.8,\n\t\t\t\t\t\t\t\t\t\"rgb(50,102,0)\"\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t// increase radius as zoom increases\n\t\t\t\t\t\t\t\t\"heatmap-radius\": {stops: [[11, 15],[15, 20]]},\n\t\t\t\t\t\t\t\t// decrease opacity to transition into the circle layer\n\t\t\t\t\t\t\t\t\"heatmap-opacity\": {\n\t\t\t\t\t\t\t\t\tdefault: 1,\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[11, 1],\n\t\t\t\t\t\t\t\t\t\t[12, 0]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"waterway-label\"\n\t\t\t\t\t);\n\n\t\t\t\t\tmap.current.addLayer(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"users-point\",\n\t\t\t\t\t\t\ttype: \"circle\",\n\t\t\t\t\t\t\tsource: \"users\",\n\t\t\t\t\t\t\tminzoom: 5,\n\t\t\t\t\t\t\tpaint: {\n\t\t\t\t\t\t\t\t// increase the radius of the circle as the zoom level and weight increases\n\t\t\t\t\t\t\t\t// \"circle-radius\": {property: \"weight\",type: \"exponential\",stops: [[{ zoom: 15, value: 1 }, 20],[{ zoom: 15, value: 62 }, 40],[{ zoom: 22, value: 1 }, 80],[{ zoom: 22, value: 62 }, 200]]},\n\t\t\t\t\t\t\t\t\"circle-radius\": 8,\n\t\t\t\t\t\t\t\t// \"circle-color\": \"rgb(0,255,0)\",\n\t\t\t\t\t\t\t\t\"circle-color\": {\n\t\t\t\t\t\t\t\t\tproperty: \"attention\",\n\t\t\t\t\t\t\t\t\ttype: \"exponential\",\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[0, \"rgb(0,225,0)\"],\n\t\t\t\t\t\t\t\t\t\t[1, \"rgb(255,200,0)\"]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\"circle-stroke-color\": \"rgba(0,100,0, 0.3)\",\n\t\t\t\t\t\t\t\t\"circle-stroke-width\": 1,\n\t\t\t\t\t\t\t\t\"circle-opacity\": {\n\t\t\t\t\t\t\t\t\tstops: [\n\t\t\t\t\t\t\t\t\t\t[11, 0],\n\t\t\t\t\t\t\t\t\t\t[12, 1]\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"waterway-label\"\n\t\t\t\t\t);\n\n\t\t\t\t\tmap.current.on(\"click\", \"users-point\", ({ features }) => {\n\t\t\t\t\t\tconst { users } = features[0].properties;\n\t\t\t\t\t\tconsole.log(typeof JSON.parse(users)[0][\"timestamp\"], JSON.parse(users)[0][\"timestamp\"]);\n\t\t\t\t\t\tconst myComp = formPopup(JSON.parse(users));\n\t\t\t\t\t\t// (\n\t\t\t\t\t\t// \t<div>\n\t\t\t\t\t\t// \t\t{JSON.parse(users).map((user) =>\n\t\t\t\t\t\t// \t\t\t<div className=\"user-container\" key={`USER_INFO_BOX_FOR_${user[\"email\"]}`}>\n\t\t\t\t\t\t// \t\t\t\t<h1>{`${user[\"name\"]} '${user[\"year\"]}`}</h1>\n\t\t\t\t\t\t// \t\t\t\t{user[\"roommate\"] ? <h3><b>Looking for a house/roommate</b></h3> : null}\n\t\t\t\t\t\t// \t\t\t\t<p>Major(s): {user[\"major\"]}</p>\n\t\t\t\t\t\t// \t\t\t\t<p>What I&apos;m doing here: {user[\"activity\"]}</p>\n\t\t\t\t\t\t// \t\t\t\t{user[\"contact\"] ? <p>Contact: {user[\"contact\"]}</p> : null}\n\t\t\t\t\t\t// \t\t\t\t<p>Last updated: {new Date(user[\"timestamp\"]).toLocaleDateString()}</p>\n\t\t\t\t\t\t// \t\t\t</div>) }\n\t\t\t\t\t\t// \t</div>\n\t\t\t\t\t\t// );\n        \n\t\t\t\t\t\taddPopup(myComp, features[0].geometry.coordinates);\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tconst mapEnd = performance.now();\n\t\t\t\t\n\t\t\t\tconsole.log(`Mapping records took ${mapEnd - mapStart} milliseconds`);\n\n\n\n\t\t\t});\n\t});\n\tlet options;\n\n\tif (users) {\n\t\t// console.log(users);\n\t\toptions = Object.keys(users).map((email) => {\n\t\t\t// console.log(email);\n\t\t\treturn {\n\t\t\t\temail,\n\t\t\t\tname: users[email].properties.users[0].name,\n\t\t\t\tlocation: users[email].geometry.coordinates,\n\t\t\t\tuserData: users[email].properties.users\n\t\t\t};\n\t\t});\n\t} else {\n\t\toptions = [];\n\t}\n\treturn (\n\n\t\t<div>\n\t\t\t<div className=\"sidebar\">\n\t\t\t\t<p>Long: {lng} | Lat: {lat} | Zoom: {zoom}</p>\n\t\t\t\t<p>Zoom in to see roommate seekers!</p>\n\t\t\t\t\n\t\t\t\t<Button style={{marginRight:10}} className=\"action_button\" size=\"small\" variant=\"outlined\" onClick={()=>setSearch(true)}>\n    search\n\t\t\t\t</Button>\n\t\t\t\t<Button className=\"action_button\" size=\"small\" variant=\"outlined\" href=\"https://docs.google.com/forms/d/e/1FAIpQLSeL_-gto_kwPpzbZCJaGejjlfbrLwmW1TqobfToT4AHlxPIGA/viewform?usp=sf_link\">\n    students\n\t\t\t\t</Button>\n\t\t\t\t<Button style={{ margin: 10 }} className=\"action_button\" size=\"small\" variant=\"outlined\" href=\"https://docs.google.com/forms/d/e/1FAIpQLSfN9_kXsE0C4RcdjWCGpTgGH4cwAgVoAeKLCxVW9voIYm4BLQ/viewform?usp=sf_link\">\n    alums\n\t\t\t\t</Button>\n\t\t\t\t\n\t\t\t\t<Modal center \n\t\t\t\t\tclassNames={{\n\t\t\t\t\t\toverlay: \"customOverlay\",\n\t\t\t\t\t\tmodal: \"customModal\",\n\t\t\t\t\t}}\n\t\t\t\t\topen={search} onClose={() => setSearch(false)}>\n\t\t\t\t\t<ThemeProvider theme={theme}>\n\t\t\t\t\t\t<Autocomplete \n\t\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\t\t// renderOption={(props, option)=>{\n\t\t\t\t\t\t\t// \tconsole.log(option);\n\t\t\t\t\t\t\t// \treturn (\n\t\t\t\t\t\t\t// \t\t<li {...props} key={option.email}>\n\t\t\t\t\t\t\t// \t\t\t{option.name}\n\t\t\t\t\t\t\t// \t\t</li>\n\t\t\t\t\t\t\t// \t);\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\tisOptionEqualToValue={(option, value) => option.email === value.email}\n\t\t\t\t\t\t\tgetOptionLabel={(option) => option.name}\n\t\t\t\t\t\t\tautoComplete\n\t\t\t\t\t\t\trenderInput={(params) => <TextField {...params} label=\"Search\" />}\n\t\t\t\t\t\t\tsx={{color: \"black\"}}\n\t\t\t\t\t\t\tonChange={(e, val) => {\n\t\t\t\t\t\t\t// console.log(val);\n\t\t\t\t\t\t\t// console.log(users);\n\t\t\t\t\t\t\t\tsetSearch(false);\n\t\t\t\t\t\t\t\t// console.log(map);\n\t\t\t\t\t\t\t\t// console.log(val);\n\t\t\t\t\t\t\t\tmap.current.flyTo(\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tcenter: val.location,\n\t\t\t\t\t\t\t\t\t\tzoom: 13\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tconsole.log(val.userData);\n\t\t\t\t\t\t\t\tconst myPopup = formPopup(val.userData);\n\t\t\t\t\t\t\t\tconsole.log(myPopup);\n\t\t\t\t\t\t\t\taddPopup(myPopup, val.location);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\n\t\t\t\t\t\t/>\n\t\t\t\t\t</ThemeProvider>\n\n\t\t\t\t</Modal>\n\t\t\t\t\n\n\t\t\t</div>\n      \n\t\t\t<div ref={mapContainer} className=\"map-container\" />\n      \n\t\t</div>\n\n\t);\n}"]},"metadata":{},"sourceType":"module"}